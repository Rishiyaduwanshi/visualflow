{% extends 'base.html' %}

{% block title %}Diagram - VisualFlow{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-8">
    {% if session.status == 'completed' %}
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-white mb-4">Your Diagram is Ready! ğŸ‰</h1>
            <p class="text-gray-300">Generated from: "{{ session.prompt }}"</p>
        </div>

        <!-- Diagram Display -->
        <div class="bg-gray-900 rounded-xl shadow-2xl border border-gray-800 p-8 mb-8">
            <div class="text-center">
                <div class="mermaid">{{ session.diagram_svg|safe }}</div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-center space-x-4 mb-8">
            <a href="{% url 'diagrams:download' session.id %}?format=png" 
               class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-6 py-3 rounded-lg transition duration-200 font-semibold shadow-lg">
                ğŸ“¥ Download Image
            </a>
            <a href="{% url 'diagrams:home' %}" 
               class="bg-gray-700 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition duration-200 font-semibold border border-gray-600">
                ğŸ†• Create New
            </a>
        </div>

    {% elif session.status == 'failed' %}
        <!-- Error Display -->
        <div class="text-center py-16">
            <div class="text-6xl mb-4">ğŸ˜</div>
            <h2 class="text-2xl font-bold text-red-400 mb-4">Oops! Something went wrong</h2>
            <p class="text-red-300 mb-6">We couldn't generate your diagram. Please try again.</p>
            <a href="{% url 'diagrams:home' %}" 
               class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-6 py-3 rounded-lg transition duration-200 font-semibold shadow-lg">
                ğŸ”„ Try Again
            </a>
        </div>

    {% else %}
        <!-- Processing Display -->
        <div class="text-center py-16">
            <div class="text-6xl mb-4">â³</div>
            <h2 class="text-2xl font-bold text-yellow-400 mb-4">Creating Your Diagram...</h2>
            <p class="text-yellow-300 mb-6">Our AI is working on it. This won't take long!</p>
            <div class="flex justify-center">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500"></div>
            </div>
        </div>
        
        <!-- Auto-refresh -->
        <script>
            setTimeout(() => window.location.reload(), 3000);
        </script>
    {% endif %}
</div>
{% endblock %}